<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"
    />
    <title>工程密码生成器</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft YaHei",
          sans-serif;
        -webkit-tap-highlight-color: transparent;
      }

      body {
        background: linear-gradient(135deg, #1a2980 0%, #26d0ce 100%);
        min-height: 100vh;
        padding: 16px;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .container {
        background-color: rgba(255, 255, 255, 0.98);
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        padding: 24px;
        width: 100%;
        max-width: 600px;
        margin: 0 auto;
      }

      .header {
        text-align: center;
        margin-bottom: 24px;
      }

      h1 {
        color: #1a2980;
        font-size: clamp(1.5rem, 5vw, 2rem);
        font-weight: 700;
        margin-bottom: 8px;
        line-height: 1.3;
      }

      .subtitle {
        color: #666;
        font-size: clamp(0.9rem, 3vw, 1rem);
      }

      .current-date {
        background: linear-gradient(135deg, #1a2980, #26d0ce);
        color: white;
        border-radius: 15px;
        padding: 18px;
        text-align: center;
        margin-bottom: 20px;
        box-shadow: 0 5px 15px rgba(26, 41, 128, 0.2);
      }

      .date-label {
        font-size: clamp(0.9rem, 3vw, 1rem);
        opacity: 0.9;
        margin-bottom: 6px;
      }

      .date-value {
        font-size: clamp(1.3rem, 6vw, 1.8rem);
        font-weight: 700;
        font-family: "Courier New", monospace;
      }

      .password-section {
        background-color: #f8f9fa;
        border-radius: 15px;
        padding: 24px;
        margin-bottom: 24px;
        border: 2px dashed #26d0ce;
      }

      .password-label {
        color: #555;
        font-size: clamp(1rem, 4vw, 1.2rem);
        text-align: center;
        margin-bottom: 15px;
      }

      .password-display {
        background: white;
        border-radius: 12px;
        padding: 20px 15px;
        text-align: center;
        margin-bottom: 20px;
        border: 2px solid #1a2980;
      }

      .password-value {
        font-size: clamp(2rem, 10vw, 3rem);
        font-weight: 800;
        color: #1a2980;
        font-family: "Courier New", monospace;
        letter-spacing: 2px;
        word-break: break-all;
        line-height: 1.2;
      }

      .buttons {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        justify-content: center;
      }

      .btn {
        padding: 14px 24px;
        border-radius: 50px;
        font-size: clamp(0.95rem, 3.5vw, 1.05rem);
        font-weight: 600;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        flex: 1;
        min-width: 140px;
      }

      .btn-primary {
        background: linear-gradient(to right, #26d0ce, #1a9b9a);
        color: white;
        box-shadow: 0 4px 12px rgba(38, 208, 206, 0.3);
      }

      .btn-primary:hover,
      .btn-primary:active {
        background: linear-gradient(to right, #1a9b9a, #158080);
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(38, 208, 206, 0.4);
      }

      .btn-secondary {
        background: #f1f3f5;
        color: #555;
        border: 1px solid #ddd;
      }

      .btn-secondary:hover,
      .btn-secondary:active {
        background: #e9ecef;
        transform: translateY(-2px);
      }

      .calculation {
        background-color: #f0f7ff;
        border-radius: 12px;
        padding: 18px;
        margin-bottom: 24px;
        border-left: 4px solid #1a2980;
      }

      .calculation h3 {
        color: #1a2980;
        font-size: clamp(1rem, 4vw, 1.1rem);
        margin-bottom: 12px;
      }

      .calculation-content {
        font-size: clamp(1.1rem, 4.5vw, 1.3rem);
        font-family: "Courier New", monospace;
        color: #333;
        text-align: center;
        background: white;
        padding: 12px;
        border-radius: 8px;
        word-break: break-all;
      }

      .table-section {
        margin-bottom: 20px;
      }

      .table-title {
        color: #1a2980;
        font-size: clamp(1rem, 4vw, 1.2rem);
        margin-bottom: 12px;
        text-align: center;
      }

      .password-table {
        width: 100%;
        border-collapse: collapse;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        border-radius: 10px;
        overflow: hidden;
        font-size: clamp(0.85rem, 3vw, 1rem);
      }

      .password-table th {
        background-color: #1a2980;
        color: white;
        padding: 14px 10px;
        font-weight: 600;
        text-align: center;
      }

      .password-table td {
        padding: 12px 10px;
        text-align: center;
        border-bottom: 1px solid #eee;
      }

      .password-table tr:nth-child(even) {
        background-color: #f8f9fa;
      }

      .password-table tr:hover {
        background-color: #e9f7fe;
      }

      .current-row {
        background-color: #d4edda !important;
        font-weight: bold;
        color: #155724;
      }

      .footer {
        text-align: center;
        color: #777;
        font-size: clamp(0.8rem, 3vw, 0.9rem);
        padding-top: 16px;
        border-top: 1px solid #eee;
        line-height: 1.5;
      }

      /* 手机端优化 */
      @media (max-width: 768px) {
        body {
          padding: 12px;
          display: block;
          min-height: 100vh;
        }

        .container {
          padding: 20px 16px;
          border-radius: 16px;
          margin-top: 0;
        }

        .password-section {
          padding: 20px 16px;
        }

        .password-display {
          padding: 16px 12px;
        }

        .password-value {
          font-size: clamp(1.8rem, 12vw, 2.5rem);
        }

        .btn {
          padding: 14px 20px;
          min-width: 120px;
        }

        .buttons {
          flex-direction: column;
        }

        .calculation {
          padding: 16px;
        }

        .password-table th,
        .password-table td {
          padding: 10px 8px;
        }
      }

      /* 平板优化 */
      @media (min-width: 769px) and (max-width: 1024px) {
        .container {
          max-width: 700px;
          padding: 28px;
        }

        .password-value {
          font-size: 2.8rem;
        }
      }

      /* 电脑大屏优化 */
      @media (min-width: 1025px) {
        .container {
          max-width: 700px;
          padding: 32px;
        }

        .password-value {
          font-size: 3.2rem;
        }

        .btn {
          padding: 16px 28px;
        }
      }

      /* 防止移动端长按菜单 */
      .password-display,
      .password-value {
        -webkit-user-select: text;
        user-select: text;
      }

      /* 加载动画 */
      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: #fff;
        animation: spin 1s ease-in-out infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
    </style>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>工程密码生成器</h1>
        <p class="subtitle">根据日期尾数自动生成六位数密码</p>
      </div>

      <div class="current-date">
        <div class="date-label">当前日期</div>
        <div class="date-value" id="currentDate">正在获取日期...</div>
      </div>

      <div class="password-section">
        <div class="password-label">今日工程密码</div>
        <div class="password-display">
          <div class="password-value" id="finalPassword">---</div>
        </div>
        <div class="buttons">
          <button class="btn btn-primary" id="copyBtn">
            <i class="fas fa-copy"></i> 复制密码
          </button>
          <button class="btn btn-secondary" id="refreshBtn">
            <i class="fas fa-redo"></i> 刷新
          </button>
        </div>
      </div>

      <div class="calculation">
        <h3>计算过程</h3>
        <div class="calculation-content" id="calculation">等待计算...</div>
      </div>

      <div class="table-section">
        <div class="table-title">密码对照表</div>
        <table class="password-table">
          <thead>
            <tr>
              <th>日期尾数</th>
              <th>对应密码</th>
            </tr>
          </thead>
          <tbody id="passwordTable">
            <!-- 表格内容将由JavaScript生成 -->
          </tbody>
        </table>
      </div>

      <div class="footer">
        <p>根据当日日期最后一位数字查找对应密码，然后相加得到六位数工程密码</p>
        <p>密码每30秒自动刷新一次</p>
      </div>
    </div>

    <script>
      // 密码对照表
      const passwordMap = {
        0: "213518",
        1: "658035",
        2: "235657",
        3: "567534",
        4: "647825",
        5: "234700",
        6: "127347",
        7: "648924",
        8: "733782",
        9: "553456",
      };

      // 获取当前日期并格式化为YYMMDD
      function getFormattedDate() {
        const now = new Date();
        const year = now.getFullYear().toString().slice(-2);
        const month = (now.getMonth() + 1).toString().padStart(2, "0");
        const day = now.getDate().toString().padStart(2, "0");
        return year + month + day;
      }

      // 获取当前日期格式化显示
      function getFormattedDateDisplay() {
        const now = new Date();
        const year = now.getFullYear();
        const month = (now.getMonth() + 1).toString().padStart(2, "0");
        const day = now.getDate().toString().padStart(2, "0");
        return `${year}年${month}月${day}日 (${year.toString().slice(-2)}${month}${day})`;
      }

      // 数字相加函数
      function addSixDigitNumbers(num1, num2) {
        let sum = parseInt(num1) + parseInt(num2);
        let result = sum.toString();
        if (result.length > 6) {
          result = result.slice(-6);
        }
        return result.padStart(6, "0");
      }

      // 生成并显示密码
      function generatePassword() {
        const dateStr = getFormattedDate();
        const lastDigit = dateStr.slice(-1);
        const mappedPassword = passwordMap[lastDigit];

        // 计算最终密码
        const finalPassword = addSixDigitNumbers(dateStr, mappedPassword);

        // 显示当前日期
        document.getElementById("currentDate").textContent =
          `${getFormattedDateDisplay()} - 尾数: ${lastDigit}`;

        // 显示最终密码
        document.getElementById("finalPassword").textContent = finalPassword;

        // 显示计算过程
        document.getElementById("calculation").innerHTML =
          `${dateStr} + ${mappedPassword} = <strong>${finalPassword}</strong>`;

        // 更新表格，高亮当前行
        updateTable(lastDigit);

        return finalPassword;
      }

      // 更新表格并高亮当前行
      function updateTable(currentLastDigit) {
        const tableBody = document.getElementById("passwordTable");
        tableBody.innerHTML = "";

        for (let i = 0; i <= 9; i++) {
          const row = document.createElement("tr");

          if (i.toString() === currentLastDigit) {
            row.className = "current-row";
          }

          row.innerHTML = `
                    <td>${i}</td>
                    <td>${passwordMap[i]}</td>
                `;

          tableBody.appendChild(row);
        }
      }

      // 复制密码到剪贴板
      function copyToClipboard(text) {
        navigator.clipboard
          .writeText(text)
          .then(() => {
            const copyBtn = document.getElementById("copyBtn");
            const originalHTML = copyBtn.innerHTML;
            copyBtn.innerHTML = '<i class="fas fa-check"></i> 已复制';
            copyBtn.style.background =
              "linear-gradient(to right, #28a745, #218838)";

            setTimeout(() => {
              copyBtn.innerHTML = originalHTML;
              copyBtn.style.background =
                "linear-gradient(to right, #26d0ce, #1a9b9a)";
            }, 2000);
          })
          .catch((err) => {
            console.error("复制失败: ", err);
            // 备用复制方法
            const textArea = document.createElement("textarea");
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
              document.execCommand("copy");
              const copyBtn = document.getElementById("copyBtn");
              const originalHTML = copyBtn.innerHTML;
              copyBtn.innerHTML = '<i class="fas fa-check"></i> 已复制';
              copyBtn.style.background =
                "linear-gradient(to right, #28a745, #218838)";

              setTimeout(() => {
                copyBtn.innerHTML = originalHTML;
                copyBtn.style.background =
                  "linear-gradient(to right, #26d0ce, #1a9b9a)";
              }, 2000);
            } catch (err) {
              alert("复制失败，请手动选择密码文本进行复制。");
            }
            document.body.removeChild(textArea);
          });
      }

      // 显示加载状态
      function showLoading() {
        document.getElementById("finalPassword").innerHTML =
          '<span class="loading"></span>';
        document.getElementById("calculation").textContent = "正在计算...";
      }

      // 初始化页面
      document.addEventListener("DOMContentLoaded", function () {
        // 初始生成密码
        showLoading();
        setTimeout(() => {
          const password = generatePassword();

          // 添加复制按钮事件
          document
            .getElementById("copyBtn")
            .addEventListener("click", function () {
              copyToClipboard(password);
            });

          // 添加刷新按钮事件
          document
            .getElementById("refreshBtn")
            .addEventListener("click", function () {
              showLoading();
              setTimeout(() => {
                generatePassword();
              }, 300);
            });

          // 每30秒更新一次
          setInterval(() => {
            generatePassword();
          }, 30000);
        }, 500);
      });

      // 添加触摸设备优化
      document.addEventListener("touchstart", function () {}, {
        passive: true,
      });

      // 防止双击缩放
      let lastTouchEnd = 0;
      document.addEventListener(
        "touchend",
        function (event) {
          const now = Date.now();
          if (now - lastTouchEnd <= 300) {
            event.preventDefault();
          }
          lastTouchEnd = now;
        },
        false,
      );
    </script>
  </body>
</html>
